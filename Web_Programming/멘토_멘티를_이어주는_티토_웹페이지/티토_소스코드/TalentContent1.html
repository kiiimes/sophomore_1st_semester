<!DOCTYPE html>
<html>
<link href="./bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css"/>
<!-- jQuery (부트스트랩의 자바스크립트 플러그인을 위해 필요한) -->
 <script type="text/javascript" src="http://code.jquery.com/jquery.js"></script>
 <meta charset="utf-8">
 <title>멘토와 멘티를 이어주는 티토</title>
<head>
	<title>TEETO</title>
	<link href="main.css" rel="stylesheet" />
  <link href="TalentContent1.css" rel="stylesheet" />
  <link href="bootstrap.css" rel="stylesheet" />
	<meta charset="UTF-8" />
	<script src="main.js"></script>
  <link href="index.css" rel="stylesheet" />
  <script src="index.js"></script>
  <script src="masonry.pkgd.min.js"></script>
  <!-- small menu slide function -->
 <script>
   $(document).ready(function(){
     $("#iconlink").click(function(){
       $("#smallmenu").slideToggle('normal');
     });
   });
  </script>
  <!-- dynamic web inner stylesheet -->
  <style>
	 	@media screen and (max-width:1400px){
	   	#main-right{
	     margin-left: 0;
	     margin-top: 0;
	   	}
	   	#content {
	     	margin: 0;
	     	width: 960px;
	   	}
			#left{
	    	display:none;
	    }
  	}
    @media screen and (min-width:1401px){
    	#menu-icon{
      	display:none;
    	}
     	#smallmenu{
       	display:none;
      }
    }
    #smallmenu{
    	display:none;
      width:200px;
      margin:0 auto;
    }
  </style>
</head>

<body>
  <!--회원가입 로그인-->
  <div id="login">
    <div id="wh">
      <header>
                <h1>로그인</h1>
                <a href="javascript:;" class="xbtn" onclick="close_login()"></a>
            </header>
            <section>
        <h3>ＩＤ</h3>
        <input type="text" id="lid">
        <br/>
        <h3>ＰＷ</h3>
        <input type="password" id="lpw">
        <br/>
        <a href="javascript:;" onclick="log_in()">로그인</a>
        <a href="javascript:;" onclick="logtoreg()">회원가입</a>
            </section>
    </div>
  </div>
  <div id="sign">
    <div id="wh">
      <header>
                <h1>회원가입</h1>
                <a href="javascript:;" class="xbtn" onclick="close_sign()"></a>
            </header>
            <section>
        <h3>ＩＤ</h3>
        <input type="text" id="rid">
        <br/>
        <h3>ＰＷ</h3>
        <input type="password" id="rpw">
        <br/>
        <h3>PW확인</h3>
        <input type="password" id="re-pw">
        <a href="javascript:;" onclick="reg()">회원가입</a>
            </section>

    </div>
  </div>
  <!--메뉴-->
  <div id="main-wrapper">

    <div id="smallmenu">
            <nav class="menu">
            <ul class="main-menu">

              <li class="outer-menu">
                <span><a href="search.html" class="m">멘토검색</a></span>
              </li>

              <li class="outer-menu">
                <span><a href="best_mento.html" class="m">인기멘토</a></span>
              </li>
              <li class="outer-menu">
                <span><a class="m1" href="javascript:;" onclick="menuOpen(1)">재능기부</a></span>
                <ul class="inner-menu menu_no1">
                  <li class="inner-menu-item"><a href="Talent.html">재능기부란?</a></li>
                  <li class="inner-menu-item">
                    <span><a href="javascript:;" onclick="smenuOpen()">재능기부 신청</a></span>
                    <ul class="talent">
                      <li class="inner-inner-menu-item"><a href="TalentList1.html">지식,기술 기부</a></li>
                      <li class="inner-inner-menu-item"><a href="TalentList2.html">강연,설명회 기부</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li class="outer-menu">
                <span><a class="m2" href="javascript:;" onclick="menuOpen(2)">게시판</a></span>
                <ul class="inner-menu menu_no2">
                  <li class="inner-menu-item"><a href="notice.html">공지사항</a></li>
                  <li class="inner-menu-item"><a href="free.html">자유게시판</a></li>
                </ul>
              </li>
            </ul>
          </nav></div>
    <div id="left">
            <nav id="upper-link">
              <br/>
              <a class="sitemap-link" href="javascript:;" onclick="login()">로그인</a>
              <a class="header-bar">|</a>
              <a class="-link" href="javascript:;" onclick="signup()">회원가입</a>
            </nav>
            <header class="logo">
              <a href="index.html"></a>
            </header>
            <nav class="menu">
              <ul class="main-menu">

                <li class="outer-menu">
                  <span><a href="search.html" class="m">멘토검색</a></span>
                </li>
                <li class="outer-menu">
                  <span><a href="best_mento.html" class="m">인기멘토</a></span>
                </li>
                <li class="outer-menu">
                  <span><a class="m1" href="javascript:;" onclick="menuOpen(1)">재능기부</a></span>
                  <ul class="inner-menu menu_no1">
                    <li class="inner-menu-item"><a href="Talent.html">재능기부란?</a></li>
                    <li class="inner-menu-item">
                      <span><a href="javascript:;" onclick="smenuOpen()">재능기부 신청</a></span>
                      <ul class="talent">
                        <li class="inner-inner-menu-item"><a href="TalentList1.html">지식,기술 기부</a></li>
                        <li class="inner-inner-menu-item"><a href="TalentList2.html">강연,설명회 기부</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li class="outer-menu">
                  <span><a class="m2" href="javascript:;" onclick="menuOpen(2)">게시판</a></span>
                  <ul class="inner-menu menu_no2">
                    <li class="inner-menu-item"><a href="notice.html">공지사항</a></li>
                    <li class="inner-menu-item"><a href="free.html">자유게시판</a></li>
                  </ul>
                </li>
              </ul>
            </nav>
            <!--Footer-->
            <footer>
              <img class="foot-logo" src="resource_main/footer_logo2.png" width="260px" height="130px" />
              <p class="description">웹프로그래밍 팀플</p>
            </footer>
          </div>
    <div id="menu-icon">
            <a href="#" id="iconlink"><img id="icon" src="search/메인 아이콘.png" alt="메인 아이콘" width=40 height=40/></a>
          </div>
  </div>
  <!--본문-->
  <div id="main-right">
      <div id="content">
    <h1>재능 기부</h1>
    <hr />
    <br/>
    <section id="main-section">
      <article>
        <br />
        <div class="article-body">
          <br />
          <div class="subject">간단한 C코딩 기초교실을 엽니다.</div>
          <br />
          <hr style="border:dashed 1px gray"/>
          <div class="content-item">
            <p>재능 기부를 하려고 합니다.</p>
            <p>아예 코딩을 모르는 분들을 대상으로 멘토멘티를 할 예정이니 기초를 아시는 분들에겐 추천드리지 않습니다.</p>
            <p>제한 인원은 5명까지 받으려고 합니다.</p>
            <p>많은 참여 부탁드립니다.</p>
          </div>
          <!--댓글-->
          <div id="comment">
            <table id="commentTable" class="table table-condensed"></table>
              <table class="table table-condensed">
                 <tr>
                     <td>
                         <span class="form-inline" role="form">
                             <p>
                                 <div class="form-group">
                                     <input type="text" id="commentParentName" name="commentParentName" class="form-control col-lg-2" data-rule-required="true" placeholder="이름" maxlength="10">
                                 </div>
                                 <div class="form-group">
                                     <input type="password" id="commentParentPassword" name="commentParentPassword" class="form-control col-lg-2" data-rule-required="true" placeholder="패스워드" maxlength="10">
                                 </div>

                                 <div class="form-group">
                                     <button type="button" id="commentParentSubmit" name="commentParentSubmit" class="btn btn-default">확인</button>
                                 </div>
                             </p>
                             <textarea id="commentParentText" class="form-control col-lg-12" style="width:100%" rows="4"></textarea>
                         </span>
                     </td>
                 </tr>
             </table>
          </div>
           <script>
            $(function(){
                //제일 하단에 있는 depth1의 댓글을 다는 이벤트
                $("#commentParentSubmit").click(function( event ) {

                    var pName = $("#commentParentName");
                    var pPassword = $("#commentParentPassword");
                    var pText = $("#commentParentText");

                    if($.trim(pName.val())==""){
                        alert("이름을 입력하세요.");
                        pName.focus();
                        return;
                    }else if($.trim(pPassword.val())==""){
                        alert("패스워드를 입력하세요.");
                        pPassword.focus();
                        return;
                    }else if($.trim(pText.val())==""){
                        alert("내용을 입력하세요.");
                        pText.focus();
                        return;
                    }

                    var commentParentText = '<tr id="r1" name="commentParentCode">'+
                                                '<td colspan=2>'+
                                                    '<strong>'+pName.val()+'</strong> '+' <a style="cursor:pointer;" name="pAdd">답글</a> | <a style="cursor:pointer;" name="pDel">삭제</a><p>'+pText.val().replace(/\n/g, "<br>")+'</p>'+
                                                '</td>'+
                                            '</tr>';

                    //테이블의 tr자식이 있으면 tr 뒤에 붙인다. 없으면 테이블 안에 tr을 붙인다.
                    if($('#commentTable').contents().size()==0){
                        $('#commentTable').append(commentParentText);
                    }else{
                        $('#commentTable tr:last').after(commentParentText);
                    }

                    $("#commentParentName").val("");
                    $("#commentParentPassword").val("");
                    $("#commentParentText").val("");

                });

                //댓글의 댓글을 다는 이벤트
                $(document).on("click","#commentChildSubmit", function(){

                    var cName = $("#commentChildName");
                    var cPassword = $("#commentChildPassword");
                    var cText = $("#commentChildText");

                    if($.trim(cName.val())==""){
                        alert("이름을 입력하세요.");
                        cName.focus();
                        return;
                    }else if($.trim(cPassword.val())==""){
                        alert("패스워드를 입력하세요.");
                        cPassword.focus();
                        return;
                    }else if($.trim(cText.val())==""){
                        alert("내용을 입력하세요.");
                        cText.focus();
                        return;
                    }

                    var commentChildText = '<tr name="commentChildCode">'+
                                                '<td style="width:1%"><span class="glyphicon glyphicon-arrow-right"></span></td>'+
                                                '<td style="width:99%">'+
                                                    '<strong>'+cName.val()+'</strong> '+cPassword.val()+' <a style="cursor:pointer;" name="cAdd">답글</a> | <a style="cursor:pointer;" name="cDel">삭제</a>'+
                                                    '<p>'+cText.val().replace(/\n/g, "<br>")+'</p>'+
                                                '</td>'+
                                            '</tr>';

                    //앞의 tr노드 찾기
                    var prevTr = $(this).parent().parent().parent().parent().prev();
                    //댓글 적는 에디터 삭제
                    $("#commentEditor").remove();//여기에서 삭제를 해줘야 에디터tr을 안 찾는다.

                    //댓글을 타고 올라가며 부모 tr을 찾음
                    while(prevTr.attr("name")!="commentParentCode"){
                        prevTr = prevTr.prev();
                    }
                    //while를 타는지 체크
                    var check = false;
                    //다음 노드가 댓글(depth1)의 댓글인지 찾기위해 next
                    var nextTr = prevTr.next();
                    //뒤에 댓글(depth1)의 댓글(depth2_1)이 없다면 바로 붙인다.
                    if(nextTr.attr("name")!="commentChildCode"){
                        prevTr.after(commentChildText);
                    }else{
                        //댓글(depth1)의 댓글(depth2_n)이 있는경우 마지막까지 찾는다.
                        while(nextTr.attr("name")=="commentChildCode"){
                            nextTr = nextTr.next();
                            check = true;
                        }
                    }

                    if(check){//댓글(depth1)의 댓글(depth2_n)이 있다면 그 댓글(depth2_n) 뒤에 댓글(depth2_n+1) 추가
                        nextTr = nextTr.prev();//while문에서 검색하느라 next로 넘거갔던거 다시 앞으로 돌려줌
                        nextTr.after(commentChildText);
                    }

                });

                //답글링크를 눌렀을때 에디터 창을 뿌려주는 이벤트, 삭제링크를 눌렀을때 해당 댓글을 삭제하는 이벤트
                $(document).on("click","table#commentTable a", function(){//동적으로 버튼이 생긴 경우 처리 방식

                    if($(this).attr("name")=="pDel"){
                        if (confirm("답글을 삭제 하시면 밑에 답글도 모두 삭제 됩니다. 정말 삭제하시겠습니까?") == true){    //확인

                            var delComment = $(this).parent().parent();
                            var nextTr = delComment.next();
                            var delTr;
                            //댓글(depth1)의 댓글(depth2_1)이 있는지 검사하여 삭제
                            while(nextTr.attr("name")=="commentCode"){
                                nextTr = nextTr.next();
                                delTr = nextTr.prev();//삭제하고 넘기면 삭제되서 없기 때문에 다음값을 가져오기 어려워 다시 앞으로 돌려서 찾은 다음 삭제
                                delTr.remove();
                            }

                            delComment.remove();

                        }else{   //취소
                            return;
                        }
                    }else if($(this).attr("name")=="cDel"){
                        if (confirm("정말 삭제하시겠습니까??") == true){    //확인
                            $(this).parent().parent().remove();
                        }else{   //취소
                            return;
                        }
                    }else{
                        //자기 부모의 tr을 알아낸다.
                        var parentElement = $(this).parent().parent();
                        //댓글달기 창을 없앤다.
                        $("#commentEditor").remove();
                        //부모의 하단에 댓글달기 창을 삽입
                        var commentEditor = '<tr id="commentEditor">'+
                                                '<td style="width:1%"> </td>'+
                                                '<td>'+
                                                    '<span class="form-inline" role="form">'+
                                                        '<p>'+
                                                            '<div class="form-group">'+
                                                                '<input type="text" id="commentChildName" name="commentChildName" class="form-control col-lg-2" data-rule-required="true" placeholder="이름" maxlength="10">'+
                                                            '</div>'+
                                                            '<div class="form-group">'+
                                                                ' <input type="password" id="commentChildPassword" name="commentChildPassword" class="form-control col-lg-2" data-rule-required="true" placeholder="패스워드" maxlength="10">'+
                                                            '</div>'+
                                                            '<div class="form-group">'+
                                                                '<button type="button" id="commentChildSubmit" class="btn btn-default">확인</button>'+
                                                            '</div>'+
                                                        '</p>'+
                                                            '<textarea id="commentChildText" name="commentChildText" class="form-control" style="width:98%" rows="4"></textarea>'+
                                                    '</span>'+
                                                '</td>'+
                                            '</tr>';

                        parentElement.after(commentEditor);
                    }
                      });
                });
           </script>
        </div>
        <a id="topgo" href="#content"><img src="search/위로 가기.png" alt="맨 위로"/></a>
      </article>
    </section>
  </div>
  </div>
</body>

</html>
